import{v as q,y as C,r as t,n as e,F as $}from"./components-BNpk1LYi.js";import{I as E,g as T}from"./generoservice-C3ydkEny.js";import{g as k}from"./autorservice-DjIETraV.js";function J(){var o,n,c,m,x,u,p,g,h,j;const b=q(),r=C(),[f,N]=t.useState([]),[y,v]=t.useState([]),[d,I]=t.useState(null),[F,w]=t.useState(null),[i,A]=t.useState(!1),S=s=>{var a;const l=((a=s.target.files)==null?void 0:a[0])||null;w(l)};t.useEffect(()=>{(async()=>{try{const l=await k(),a=await T();N(l),v(a)}catch(l){console.error("Error al cargar datos:",l)}})()},[]);const B=s=>{I(s)},G=s=>{A(!0),b("/panel")};return e.jsx("div",{children:e.jsxs("div",{className:"container rounded-lg max-w-6xl mx-auto mt-7 mb-7",children:[e.jsx("div",{className:"flex justify-between ml-40 items-center",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#002847]",children:"Agregar nuevo audiolibro"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Complete los detalles del audiolibro y suba los archivos necesarios"})]})}),(r==null?void 0:r.error)&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 m-6 rounded",children:[e.jsx("p",{className:"font-bold",children:"Error:"}),e.jsx("p",{children:r.error}),r.debugInfo&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"cursor-pointer text-sm",children:"Ver detalles técnicos"}),e.jsx("pre",{className:"mt-2 text-xs overflow-auto max-h-40 p-2 bg-red-50",children:JSON.stringify(r.debugInfo,null,2)})]})]}),e.jsxs($,{method:"post",className:"p-6",encType:"multipart/form-data",onSubmit:G,children:[e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Título"}),e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"titulo",placeholder:"Ingrese el título",className:`w-full px-3 py-2 border ${(o=r==null?void 0:r.errores)!=null&&o.titulo?"border-red-500":"border-gray-300"} rounded`,required:!0}),((n=r==null?void 0:r.errores)==null?void 0:n.titulo)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.titulo})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Autor"}),e.jsxs("div",{children:[e.jsxs("select",{name:"autorId",className:`w-full px-3 py-2 border ${(c=r==null?void 0:r.errores)!=null&&c.autorId?"border-red-500":"border-gray-300"} rounded`,required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un autor"}),f.map(s=>e.jsxs("option",{value:s.id,children:[s.nombre," ",s.apellidos]},s.id))]}),((m=r==null?void 0:r.errores)==null?void 0:m.autorId)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.autorId})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Género"}),e.jsxs("div",{children:[e.jsxs("select",{name:"generoId",className:`w-full px-3 py-2 border ${(x=r==null?void 0:r.errores)!=null&&x.generoId?"border-red-500":"border-gray-300"} rounded`,required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un género"}),y.map(s=>e.jsx("option",{value:s.id,children:s.nombre},s.id))]}),((u=r==null?void 0:r.errores)==null?void 0:u.generoId)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.generoId})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Duracion"}),e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"duracion",placeholder:"Ingrese la duración",className:`w-full px-3 py-2 border ${(p=r==null?void 0:r.errores)!=null&&p.duracion?"border-red-500":"border-gray-300"} rounded`,required:!0}),((g=r==null?void 0:r.errores)==null?void 0:g.duracion)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.duracion})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-start gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700 pt-2",children:"Tamaño MB"}),e.jsx("input",{type:"text",name:"tamaño_m_b",placeholder:"Ingrese el tamaño",className:"w-full px-3 py-2 border border-gray-300 rounded resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Idioma"}),e.jsx("input",{type:"text",name:"idioma",placeholder:"Ingrese el idioma",className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Narrador"}),e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"narrador",placeholder:"Ingrese el narrador",className:`w-full px-3 py-2 border ${(h=r==null?void 0:r.errores)!=null&&h.narrador?"border-red-500":"border-gray-300"} rounded`,required:!0}),((j=r==null?void 0:r.errores)==null?void 0:j.isnarradorbn)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.narrador})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{htmlFor:"pdf",className:"text-right font-medium text-gray-700",children:"Audio o video"}),e.jsx("div",{className:"flex",children:e.jsx("input",{type:"file",id:"pathArchivo",name:"pathArchivo",accept:".mp3, .mp4",required:!0,onChange:S})})]}),e.jsxs("div",{className:"flex flex-col items-center my-10",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portada del audiolibro"}),e.jsx(E,{onBase64Generated:B,stripPrefix:!0}),d&&e.jsx("div",{className:"mt-4 max-w-lg mx-auto",children:e.jsx("img",{src:d.startsWith("data:")?d:`data:image/jpeg;base64,${d}`,alt:"Portada",className:"rounded-3xl border"})}),e.jsx("input",{type:"hidden",name:"portada",value:d||""})]})]}),e.jsxs("div",{className:"flex justify-end mt-8 gap-6",children:[e.jsx("button",{type:"submit",className:"bg-[#002847] text-white px-6 py-2 rounded",disabled:i,children:i?"Guardando...":"Guardar"}),e.jsx("a",{href:"/panel",className:"bg-gray-200 text-gray-800 px-6 py-2 rounded text-center",children:"Cancelar"})]})]})]})})}export{J as default};
