import{x as P,y as V,r as a,n as e,F as $}from"./components-BNpk1LYi.js";import{I as q,g as A}from"./generoservice-C3ydkEny.js";import{g as C}from"./autorservice-DjIETraV.js";function z(){var c,m,x,u,p,g,h,f,j,N,y;const{libro:s}=P(),r=V(),[b,v]=a.useState([]),[I,w]=a.useState([]),[d,n]=a.useState(null),[k,S]=a.useState(null),[o,B]=a.useState(!1),E=t=>{var i;const l=((i=t.target.files)==null?void 0:i[0])||null;S(l)};a.useEffect(()=>{(async()=>{try{const l=await C(),i=await A();v(l),w(i)}catch(l){console.error("Error al cargar datos:",l)}})(),s!=null&&s.portada&&n(s.portada)},[s]);const F=t=>{n(t)},G=t=>{B(!0)};return e.jsx("div",{children:e.jsxs("div",{className:"container rounded-lg max-w-6xl mx-auto mt-7 mb-7",children:[e.jsx("div",{className:"flex justify-between items-center ml-40",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#002847]",children:"Editar libro"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Modifique los detalles del libro"})]})}),(r==null?void 0:r.error)&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 m-6 rounded",children:[e.jsx("p",{className:"font-bold",children:"Error:"}),e.jsx("p",{children:r.error}),r.debugInfo&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"cursor-pointer text-sm",children:"Ver detalles técnicos"}),e.jsx("pre",{className:"mt-2 text-xs overflow-auto max-h-40 p-2 bg-red-50",children:JSON.stringify(r.debugInfo,null,2)})]})]}),e.jsxs($,{method:"post",className:"p-6",encType:"multipart/form-data",onSubmit:G,children:[e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Título"}),e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"titulo",placeholder:"Ingrese el título",className:`w-full px-3 py-2 border ${(c=r==null?void 0:r.errores)!=null&&c.titulo?"border-red-500":"border-gray-300"} rounded`,required:!0}),((m=r==null?void 0:r.errores)==null?void 0:m.titulo)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.titulo})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Autor"}),e.jsxs("div",{children:[e.jsxs("select",{name:"autorId",defaultValue:(s==null?void 0:s.autorId)||"",className:`w-full px-3 py-2 border ${(x=r==null?void 0:r.errores)!=null&&x.autorId?"border-red-500":"border-gray-300"} rounded`,required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un autor"}),b.map(t=>e.jsxs("option",{value:t.id,children:[t.nombre," ",t.apellidos]},t.id))]}),((u=r==null?void 0:r.errores)==null?void 0:u.autorId)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.autorId})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Género"}),e.jsxs("div",{children:[e.jsxs("select",{name:"generoId",defaultValue:(s==null?void 0:s.generoId)||"",className:`w-full px-3 py-2 border ${(p=r==null?void 0:r.errores)!=null&&p.generoId?"border-red-500":"border-gray-300"} rounded`,required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un género"}),I.map(t=>e.jsx("option",{value:t.id,children:t.nombre},t.id))]}),((g=r==null?void 0:r.errores)==null?void 0:g.generoId)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.generoId})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Editorial"}),e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"editorial",defaultValue:(s==null?void 0:s.editorial)||"",placeholder:"Ingrese la editorial",className:`w-full px-3 py-2 border ${(h=r==null?void 0:r.errores)!=null&&h.editorial?"border-red-500":"border-gray-300"} rounded`,required:!0}),((f=r==null?void 0:r.errores)==null?void 0:f.editorial)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.editorial})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-start gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700 pt-2",children:"Contraportada"}),e.jsx("textarea",{name:"contraportada",defaultValue:(s==null?void 0:s.contraportada)||"",placeholder:"Ingrese la descripción de la contraportada",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"Idioma"}),e.jsx("input",{type:"text",name:"idioma",defaultValue:(s==null?void 0:s.idioma)||"",placeholder:"Ingrese el idioma",className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{className:"text-right font-medium text-gray-700",children:"ISBN"}),e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"isbn",defaultValue:(s==null?void 0:s.isbn13)||"",placeholder:"Ingrese el ISBN",className:`w-full px-3 py-2 border ${(j=r==null?void 0:r.errores)!=null&&j.isbn?"border-red-500":"border-gray-300"} rounded`,required:!0}),((N=r==null?void 0:r.errores)==null?void 0:N.isbn)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.errores.isbn})]})]}),e.jsxs("div",{className:"grid grid-cols-[120px,1fr] items-center gap-4",children:[e.jsx("label",{htmlFor:"pdf",className:"text-right font-medium text-gray-700",children:"PDF"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("input",{type:"file",id:"pdf",name:"pdf",accept:".pdf",onChange:E}),(s==null?void 0:s.pdf)&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Ya existe un PDF. Si no selecciona uno nuevo, se mantendrá el actual."})]})]}),e.jsxs("div",{className:"flex flex-col items-center my-10",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portada del libro"}),e.jsx(q,{onBase64Generated:F,stripPrefix:!0}),(d||(s==null?void 0:s.portada))&&e.jsx("div",{className:"mt-4 max-w-lg mx-auto",children:e.jsx("img",{src:d?d.startsWith("data:")?d:`data:image/jpeg;base64,${d}`:(y=s==null?void 0:s.portada)!=null&&y.startsWith("data:")?s.portada:`data:image/jpeg;base64,${s==null?void 0:s.portada}`,alt:"Portada",className:"rounded-3xl border"})}),e.jsx("input",{type:"hidden",name:"portada",value:d||(s==null?void 0:s.portada)||""})]})]}),e.jsxs("div",{className:"flex justify-end mt-8 gap-6",children:[e.jsx("button",{type:"submit",className:"bg-[#002847] text-white px-6 py-2 rounded",disabled:o,children:o?"Guardando...":"Guardar cambios"}),e.jsx("a",{href:"/panel",className:"bg-gray-200 text-gray-800 px-6 py-2 rounded text-center",children:"Cancelar"})]})]})]})})}export{z as default};
