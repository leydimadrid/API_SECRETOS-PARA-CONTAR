import{r as p,n as e}from"./components-BNpk1LYi.js";const k=({onBase64Generated:r,stripPrefix:f=!0})=>{const[A,x]=p.useState(null),[w,c]=p.useState(null),[E,d]=p.useState(!1),[j,g]=p.useState(null),N=n=>{var m;const t=((m=n.target.files)==null?void 0:m[0])||null;if(x(t),g(null),t){if(t.size>2*1024*1024){g("La imagen es demasiado grande. El tamaño máximo es 2MB."),x(null),c(null),r("");return}d(!0);const a=new FileReader;a.onloadend=()=>{c(a.result)},a.onerror=()=>{g("Error al leer el archivo. Intente con otra imagen."),d(!1)},a.readAsDataURL(t),y(t,800,.8).then(l=>{if(f){const o=l.split(",")[1]||l;r(o)}else r(l);d(!1)}).catch(l=>{console.error("Error al comprimir la imagen:",l),g("Error al procesar la imagen. Intente con otra imagen."),d(!1)})}else c(null),r("")},y=(n,t,m)=>new Promise((a,l)=>{const o=new FileReader;o.readAsDataURL(n),o.onload=L=>{var v;const s=new Image;s.src=(v=L.target)==null?void 0:v.result,s.onload=()=>{let i=s.width,u=s.height;i>t&&(u=u*t/i,i=t);const h=document.createElement("canvas");h.width=i,h.height=u;const b=h.getContext("2d");if(!b){l(new Error("No se pudo obtener el contexto del canvas"));return}b.drawImage(s,0,0,i,u);const I=h.toDataURL("image/jpeg",m);a(I)},s.onerror=()=>{l(new Error("Error al cargar la imagen"))}},o.onerror=()=>{l(new Error("Error al leer el archivo"))}});return e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{htmlFor:"portada-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[E?e.jsx("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:e.jsx("p",{className:"mb-2 text-sm text-gray-500",children:"Cargando imagen..."})}):w?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:w||"/placeholder.svg",alt:"Vista previa",className:"w-full h-full object-contain rounded-lg"}),e.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),x(null),c(null),r("")},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-10 h-10 mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("p",{className:"mb-2 text-sm text-gray-500",children:e.jsx("span",{className:"font-semibold",children:"Haga clic para cargar"})}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG o JPEG (MAX. 2MB)"})]}),e.jsx("input",{id:"portada-upload",type:"file",className:"hidden",accept:"image/png, image/jpeg, image/jpg",onChange:N})]})}),j&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:j})]})},R="http://localhost:5046/api/genero";async function F(){try{const r=await fetch(`${R}/generos`);if(!r.ok)throw new Error("Error al obtener los generos");return(await r.json()).responseElements||[]}catch(r){console.error("Error en getAllgeneros:",r)}}export{k as I,F as g};
